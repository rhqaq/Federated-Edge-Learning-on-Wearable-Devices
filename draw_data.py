import numpy as np
import matplotlib.pyplot as plt

data_acc1 = np.load('D:\wearable\code\checkpoints\9feature_lstm_an15_D5_al1_E5_B10_lr0.05_num_clients100_cf0.1.npy')

# data_acc = np.load('/root/rh/wearable_FL/code/FedAvg/use_pytorch/checkpoints/9feature_mlp_an15_D125_al1_E5_B10_lr0.05_num_clients100_cf0.1.npy')
data_acc = np.load('D:\wearable\code\checkpoints\9feature_mlp_an15_sn3_D125_al1_E5_B250_lr0.05_num_clients100_cf0.1.npy')
data_acc2 = np.load('D:\wearable\code\checkpoints\9feature_lstm_an15_D5_al0.9_E5_B10_lr0.05_num_clients100_cf0.1.npy')
data_acc3 = np.load('D:\wearable\code\checkpoints\9feature_lstm_an15_sn3_D5_al0.5_E5_B10_lr0.05_num_clients100_cf0.1.npy')
x = [i+1 for i in range(2000)]
print(data_acc)
print(np.mean(data_acc[:,3][-50:]))
print(np.mean(data_acc1[:,3][-50:]))
print(np.mean(data_acc3[:,3][-50:]))
print(np.mean(data_acc2[:,3][-50:]))
# print(np.mean(data_acc1[:,0][:-100]))
# print(np.mean(data_acc2[:,0][:-100]))
# print(np.mean(data_acc3[:,0][:-100]))

plt.subplot(2,1,1)
l1,=plt.plot(x,  data_acc[:,0].tolist(), linestyle='-', color='#DE6B58', linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
plt.subplot(2,1,1)
plt.ylabel('Accuracy', fontsize=8, alpha=1)
l2,=plt.plot(x,  data_acc1[:,0].tolist(), linestyle='-', linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
plt.subplot(2,1,2)
l3,=plt.plot(x,  data_acc3[:,0].tolist(), linestyle='-',color='green', linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
# plt.ylabel('Accuracy', fontsize=8, alpha=1)
plt.subplot(2,1,2)
plt.ylabel('Accuracy', fontsize=8, alpha=1)
l4,=plt.plot(x,  data_acc2[:,0].tolist(), linestyle='-',color='#FE6B58', linewidth=1.5)
# plt.plot(x,  data_acc3[:,0].tolist()+data_acc1[:,0].tolist(), linestyle='-',  linewidth=1.5)
# plt.plot(x, data_acc2[:,0], linestyle='-',  linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
plt.legend(handles=[l1, l2, l3, l4], labels=['MLP-FedAvg','LSTM-FedAvg', 'LSTM-FedRS0.5','LSTM-FedRS0.9'])

plt.xlabel('Number of Rounds', fontsize=8, alpha=1)
plt.savefig('./all.png', format='png', dpi=300)
plt.show()