import numpy as np
import matplotlib.pyplot as plt

data_acc1 = np.load(r'D:\wearable\code\checkpoints\NEW43feature_mlp_an15_sn3_D125_al1_E5_B1024_lr0.05_num_clients122_cf0.1.npy')
data_acc3 = np.load(r'D:\wearable\code\checkpoints\adam4519feature_lstm_an15_sn3_D125_al1_E5_B64_lr0.05_num_clients100_cf0.1.npy')

# data_acc = np.load('/root/rh/wearable_FL/code/FedAvg/use_pytorch/checkpoints/9feature_mlp_an15_D125_al1_E5_B10_lr0.05_num_clients100_cf0.1.npy')
# data_acc = np.load(r'D:\wearable\code\checkpoints\19_9feature_mlp_an19_sn3_D25_al0.8_E5_B1024_lr0.05_num_clients100_cf0.1.npy')
# data_acc3 = np.load(r'D:\wearable\code\checkpoints\19_45feature_lstm_an19_sn4_D125_al1_E5_B64_lr0.05_num_clients100_cf0.1.npy')
data_acc2 = np.load(r'D:\wearable\code\checkpoints\adam4519feature_lstm_an15_sn3_D125_al0.9_E5_B64_lr0.05_num_clients100_cf0.1.npy')
x = [i+1 for i in range(2000)]
# print(data_acc2)
# print(np.mean(data_acc[:,3][-1050:1000]))
# print(np.mean(data_acc1[:,3][-1050:1000]))
# # print(np.mean(data_acc3[:,3][-50:]))
# print(np.mean(data_acc2[:,0][-1050:1000]))
# print(np.mean(data_acc[:,2][-25:]))
# data_acc1=data_acc1[:1000]
data_acc2=data_acc2[:1000]
data_acc3=data_acc3[:1000]
# print(data_acc1[450:500,:])
print('%.4f' % np.mean(data_acc1[:,0][-25:]))
print('%.4f' % np.mean(data_acc3[:,0][-25:]))
print('%.4f' % np.mean(data_acc2[:,0][-25:]))
print('%.4f' %np.mean(data_acc1[:,1][-25:]))
print('%.4f' %np.mean(data_acc3[:,1][-25:]))
print('%.4f' %np.mean(data_acc2[:,1][-25:]))
print('%.4f' %np.mean(data_acc1[:,2][-25:]))
print('%.4f' %np.mean(data_acc3[:,2][-25:]))
print('%.4f' %np.mean(data_acc2[:,2][-25:]))
print('%.4f' %np.mean(data_acc1[:,3][-25:]))
print('%.4f' %np.mean(data_acc3[:,3][-25:]))
print('%.4f' %np.mean(data_acc2[:,3][-25:]))
print(3)
print('%.3f' % np.mean(data_acc1[:,0][-25:]))
print('%.3f' % np.mean(data_acc3[:,0][-25:]))
print('%.3f' % np.mean(data_acc2[:,0][-25:]))
print('%.3f' %np.mean(data_acc1[:,1][-25:]))
print('%.3f' %np.mean(data_acc3[:,1][-25:]))
print('%.3f' %np.mean(data_acc2[:,1][-25:]))
print('%.3f' %np.mean(data_acc1[:,2][-25:]))
print('%.3f' %np.mean(data_acc3[:,2][-25:]))
print('%.3f' %np.mean(data_acc2[:,2][-25:]))
print('%.3f' %np.mean(data_acc1[:,3][-25:]))
print('%.3f' %np.mean(data_acc3[:,3][-25:]))
print('%.3f' %np.mean(data_acc2[:,3][-25:]))
#
# plt.subplot(2,1,1)
# l1,=plt.plot(x,  data_acc[:,0].tolist(), linestyle='-', color='#DE6B58', linewidth=1.5)
# plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
plt.subplot(2,1,1)
plt.ylabel('Accuracy', fontsize=8, alpha=1)
l2,=plt.plot(x,  data_acc1[:,0].tolist(), linestyle='-', linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
plt.subplot(2,1,2)
# l3,=plt.plot(x,  data_acc3[:,0].tolist(), linestyle='-',color='green', linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
# plt.ylabel('Accuracy', fontsize=8, alpha=1)
plt.subplot(2,1,2)
plt.ylabel('Accuracy', fontsize=8, alpha=1)
# l4,=plt.plot(x,  data_acc2[:,0].tolist(), linestyle='-',color='#FE6B58', linewidth=1.5)
plt.plot(x,  data_acc3[:,0], linestyle='-',  linewidth=1.5)
plt.plot(x, data_acc2[:,0], linestyle='-',  linewidth=1.5)
plt.axhline(y=0.9,ls="-",c="grey")
plt.ylim(0, 1)
plt.xlim(0,2000)
# # plt.legend(handles=[l1, l2, l3, l4], labels=['MLP-FedAvg','LSTM-FedAvg', 'LSTM-FedRS0.5','LSTM-FedRS0.9'])
#
# plt.xlabel('Number of Rounds', fontsize=8, alpha=1)
# plt.savefig('./all.png', format='png', dpi=300)
plt.show()